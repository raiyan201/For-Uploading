{% load static %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<link rel="stylesheet" href="{% static 'css.css'%}">
<link rel="stylesheet" href="/static/css.css">

<div class="container">
    <h1 >Users Page</h1>

{% if user.is_authenticated %}

{% comment %} <button type="button" class="btn btn-outline-info"><a href="{% url 'download-data' %}">Download</a></button>    
<button type="button" class="btn btn-outline-info"><a href="{% url 'attach-file' %}">Send-Mail-Now</a></button>     {% endcomment %}

<form name="myForm" onsubmit="return validateForm()" method="post">

{% csrf_token %}

<label for="email_id">User Email:</label>
<span id="email_error" style="color:red;"></span>    
<select name="email_id" id="email_id">
  <option value="">None</option>
  <option value="{{request.user.email}}">{{request.user.email}}</option>    
</select> 
<button type="submit" class="btn btn-outline-info">Send</a></button>    
</form>


{% comment %} <div class="form-check">
  <input class="form-check-input" type="checkbox" value="Scheduler" id="Scheduler">
  <label class="form-check-label" for="Scheduler">
  Scheduler
  </label>
</div> {% endcomment %}



{% if user.is_superuser %}
<form name="myForm2" action={% url 'mailing_all' %} onsubmit="return validateForm2()" method="post">
  {% csrf_token %}
  <br>
  <label for="email_all">All Email</label>
  <span id="email_all" style="color:red;"></span>

  <select name="email_all" id="email_all">
     <option value=reciepient_list>All</option>
     {% for user in users %}
     <option value="{{user.email}}">{{user.email}}</option>
     {% endfor %}
</select>   

<button type="submit" class="btn btn-outline-info">Send</a></button>  
</form>

{% comment %} <button type="button">Email-History</button> {% endcomment %}

{% endif %}  


{% else%}
<h1>Please Login First</h1>
<button type="button" class="btn btn-outline-success"><a href="{% url 'login' %}">Login</a></button>    
{% endif %}
</div>


<script>
      function validateForm(){
          debugger;
          let x=document.forms["myForm"]["email_id"].value;
          if (x=="") {
              document.getElementById("email_error").innerHTML=  "Required";  
              return false;
          }
          window.location.href="{% url 'mailing' %}";
          return false        
        }
</script> 


<script>

  function validateForm2(){
      debugger;
      let x=document.forms["myForm2"]["email_all"].value;
      if (x=="") {
          document.getElementById("email_all").innerHTML=  "Required";  
          return false;
      }
      return true;          
  }

</script>